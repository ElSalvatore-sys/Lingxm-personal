<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>LingXM Personal - Daily Words</title>

    <!-- PWA Configuration -->
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
    <meta name="theme-color" content="#667eea">

    <!-- iOS-specific meta tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="LingXM">
    <link rel="apple-touch-icon" href="/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/icons/icon-192x192.png">

    <!-- Service Worker Registration -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/service-worker.js')
            .then(reg => console.log('[PWA] Service Worker registered:', reg.scope))
            .catch(err => console.error('[PWA] Service Worker registration failed:', err));
        });
      }
    </script>

    <link rel="stylesheet" href="/src/styles/main.css">
</head>
<body>
    <div id="app">
        <!-- Welcome Screen (First-Time Only) -->
        <div id="welcome-screen" class="screen">
            <div class="welcome-container">
                <div class="welcome-slides">
                    <!-- Slide 1: Welcome -->
                    <div class="welcome-slide active" data-slide="0">
                        <div class="welcome-content">
                            <div class="welcome-icon">ğŸ“</div>
                            <h1 class="welcome-title">Welcome to LingXM</h1>
                            <p class="welcome-subtitle">Your personal language learning companion</p>
                            <p class="welcome-description">
                                Learn at your own pace with smart vocabulary tracking,
                                achievement badges, and personalized progress insights.
                            </p>
                        </div>
                    </div>

                    <!-- Slide 2: How to Use -->
                    <div class="welcome-slide" data-slide="1">
                        <div class="welcome-content">
                            <div class="welcome-icon">ğŸ‘†</div>
                            <h1 class="welcome-title">How to Use</h1>
                            <ul class="welcome-features">
                                <li><strong>Swipe left/right</strong> to navigate between words</li>
                                <li><strong>Tap ğŸ”Š</strong> to hear pronunciation</li>
                                <li><strong>Save words</strong> with â­ for later review</li>
                                <li><strong>Track progress</strong> with ğŸ† achievements</li>
                                <li><strong>Practice daily</strong> to build your streak ğŸ”¥</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Slide 3: Security -->
                    <div class="welcome-slide" data-slide="2">
                        <div class="welcome-content">
                            <div class="welcome-icon">ğŸ”</div>
                            <h1 class="welcome-title">Secure Your Profile</h1>
                            <p class="welcome-description">
                                Set a 4-digit PIN to protect your learning progress
                                and keep your data private.
                            </p>
                            <p class="welcome-description" style="opacity: 0.7; font-size: 0.9rem;">
                                You can skip this and add it later in settings.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Navigation -->
                <div class="welcome-nav">
                    <button id="welcome-back-btn" class="welcome-btn welcome-btn-secondary" style="display: none;">
                        â† Back
                    </button>
                    <button id="welcome-next-btn" class="welcome-btn welcome-btn-primary">
                        Next â†’
                    </button>
                    <button id="welcome-get-started-btn" class="welcome-btn welcome-btn-primary" style="display: none;">
                        Get Started!
                    </button>
                </div>

                <!-- Indicators -->
                <div class="welcome-indicators">
                    <div class="welcome-dot active" data-slide="0"></div>
                    <div class="welcome-dot" data-slide="1"></div>
                    <div class="welcome-dot" data-slide="2"></div>
                </div>

                <!-- Skip -->
                <button id="welcome-skip-btn" class="welcome-skip">Skip â†’</button>
            </div>
        </div>

        <!-- Profile Selection Screen -->
        <div id="profile-selection" class="screen active">
            <div class="profile-container">
                <h1 class="app-title">LingXM Personal</h1>
                <div class="profile-buttons">
                    <button class="profile-btn" data-profile="vahiko">
                        <div class="profile-progress-rings"></div>
                        <span class="profile-emoji">ğŸ‘©â€ğŸ’¼</span>
                        <span class="profile-name">Vahiko</span>
                        <span class="profile-langs">ğŸ‡©ğŸ‡ª Deutsch C1 â€¢ ğŸ‡¬ğŸ‡§ English B1-B2</span>
                        <div class="profile-streak"></div>
                    </button>
                    <button class="profile-btn" data-profile="hassan">
                        <div class="profile-progress-rings"></div>
                        <span class="profile-emoji">ğŸ‘¨â€ğŸ’»</span>
                        <span class="profile-name">Hassan</span>
                        <span class="profile-langs">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© B2-C1 â€¢ ğŸ‡¬ğŸ‡§ English B2-C2 â€¢ ğŸ‡©ğŸ‡ª Deutsch B1-B2</span>
                        <div class="profile-streak"></div>
                    </button>
                    <button class="profile-btn" data-profile="salman">
                        <div class="profile-progress-rings"></div>
                        <span class="profile-emoji">ğŸ‘©â€ğŸ³</span>
                        <span class="profile-name">Frau Salman</span>
                        <span class="profile-langs">ğŸ‡©ğŸ‡ª Deutsch B1-B2 â€¢ ğŸ‡©ğŸ‡ªğŸ½ï¸ Gastro â€¢ ğŸ‡«ğŸ‡· FranÃ§ais â€¢ ğŸ‡¬ğŸ‡§ English A2-B1</span>
                        <div class="profile-streak"></div>
                    </button>
                    <button class="profile-btn" data-profile="kafel">
                        <div class="profile-progress-rings"></div>
                        <span class="profile-emoji">ğŸ‘¨â€ğŸ’»</span>
                        <span class="profile-name">Kafel</span>
                        <span class="profile-langs">ğŸ‡©ğŸ‡ª Deutsch B2 â€¢ ğŸ‡©ğŸ‡ªğŸ’» IT B2 â€¢ ğŸ‡¬ğŸ‡§ English B2-C1</span>
                        <div class="profile-streak"></div>
                    </button>
                    <button class="profile-btn" data-profile="jawad">
                        <div class="profile-progress-rings"></div>
                        <span class="profile-emoji">ğŸ‘¨â€ğŸ³</span>
                        <span class="profile-name">Jawad</span>
                        <span class="profile-langs">ğŸ‡©ğŸ‡ª Deutsch B1-B2 â€¢ ğŸ‡©ğŸ‡ªğŸ½ï¸ Gastro â€¢ ğŸ‡«ğŸ‡· FranÃ§ais â€¢ ğŸ‡¬ğŸ‡§ English A2-B1</span>
                        <div class="profile-streak"></div>
                    </button>
                    <button class="profile-btn" data-profile="ameeno">
                        <div class="profile-progress-rings"></div>
                        <span class="profile-emoji">ğŸ§‘â€ğŸ“</span>
                        <span class="profile-name">Ameeno</span>
                        <span class="profile-langs">ğŸ‡©ğŸ‡ª Deutsch B1-B2 â€¢ ğŸ‡¬ğŸ‡§ English B1-B2 â€¢ ğŸ‡®ğŸ‡¹ Italiano A1</span>
                        <div class="profile-streak"></div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Learning Screen -->
        <div id="learning-screen" class="screen">
            <div class="header">
                <button id="back-btn" class="icon-btn">â†</button>
                <div class="progress-info">
                    <span id="current-lang">Deutsch</span>
                </div>
                <div class="header-actions">
                    <button id="achievements-btn" class="icon-btn">
                        ğŸ†
                        <span class="notification-badge" id="achievement-badge" style="display:none;"></span>
                    </button>
                    <button id="settings-btn" class="icon-btn">âš™ï¸</button>
                    <button id="save-word-btn" class="icon-btn">â­</button>
                </div>
            </div>

            <div class="word-card" id="word-card">
                <div class="swipe-hint">â† Previous | Next â†’</div>
                
                <div class="word-main">
                    <div class="mastery-indicator" id="mastery-indicator">
                        <div class="mastery-stars" id="mastery-stars">
                            <span class="star">â­</span>
                            <span class="star">â­</span>
                            <span class="star">â­</span>
                            <span class="star">â­</span>
                            <span class="star">â­</span>
                        </div>
                        <span class="mastery-label" id="mastery-label">New</span>
                    </div>
                    <h2 id="word-text" class="word-text">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h2>
                    <p id="word-translation" class="word-translation"></p>
                </div>

                <div class="word-details">
                    <div class="section">
                        <h3 id="explanation-header">Ø´Ø±Ø­ / ErklÃ¤rung</h3>
                        <p id="word-explanation"></p>
                    </div>

                    <div class="section" id="conjugation-section">
                        <h3 id="conjugation-header">ØªØµØ±ÙŠÙ / Konjugation</h3>
                        <div id="word-conjugations"></div>
                    </div>

                    <div class="section">
                        <h3 id="example1-header">Ù…Ø«Ø§Ù„ Ù¡ / Beispiel 1</h3>
                        <p id="example-1"></p>
                    </div>

                    <div class="section">
                        <h3 id="example2-header">Ù…Ø«Ø§Ù„ Ù¢ / Beispiel 2</h3>
                        <p id="example-2"></p>
                    </div>
                </div>
            </div>

            <div class="language-switcher">
                <button class="lang-btn" data-lang="0">Lang 1</button>
                <button class="lang-btn" data-lang="1">Lang 2</button>
                <button class="lang-btn" data-lang="2">Lang 3</button>
                <button class="lang-btn" data-lang="3">Lang 4</button>
            </div>

            <!-- Settings Modal -->
            <div id="settings-modal" class="settings-modal">
                <div class="settings-content">
                    <div class="settings-header">
                        <h2>âš™ï¸ Settings / Einstellungen</h2>
                        <button id="close-settings" class="icon-btn">âœ•</button>
                    </div>

                    <div class="settings-section">
                        <div class="setting-item">
                            <div class="setting-label">
                                <span>ğŸŒ“ Theme / Motiv</span>
                                <p class="setting-description">Switch between dark and light mode</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="theme-toggle">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-item">
                            <div class="setting-label">
                                <span>Auto-Play / Automatisch</span>
                                <p class="setting-description">Play word pronunciation automatically</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="autoplay-toggle">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-item" id="pin-setting-item" style="display:none;">
                            <div class="setting-label">
                                <span>ğŸ” PIN Security / PIN-Sicherheit</span>
                                <p class="setting-description">Protect your profile with a 4-digit PIN</p>
                            </div>
                            <button id="change-pin-btn" class="setting-action-btn">
                                Change PIN
                            </button>
                        </div>

                        <div class="setting-item">
                            <div class="setting-label">
                                <span>Speech Speed / Sprechgeschwindigkeit</span>
                                <p class="setting-description">Choose pronunciation speed</p>
                            </div>
                            <div class="speed-selector">
                                <button class="speed-btn" data-speed="slow">
                                    ğŸ¢ Slow<br>Langsam
                                </button>
                                <button class="speed-btn active" data-speed="normal">
                                    â–¶ï¸ Normal
                                </button>
                                <button class="speed-btn" data-speed="fast">
                                    ğŸ° Fast<br>Schnell
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Swipe Tutorial Overlay (First-Time Per Profile) -->
            <div id="swipe-tutorial" class="swipe-tutorial">
                <div class="swipe-tutorial-content">
                    <div class="swipe-tutorial-header">
                        <h2>ğŸ‘† Quick Tutorial</h2>
                    </div>

                    <div class="swipe-tutorial-body">
                        <div class="swipe-gesture-demo">
                            <div class="swipe-arrow swipe-left">
                                <span class="arrow-icon">ğŸ‘ˆ</span>
                                <span class="arrow-label">Swipe left<br>for next word</span>
                            </div>
                            <div class="swipe-arrow swipe-right">
                                <span class="arrow-icon">ğŸ‘‰</span>
                                <span class="arrow-label">Swipe right<br>for previous</span>
                            </div>
                        </div>

                        <div class="swipe-tutorial-tips">
                            <p><strong>Tip:</strong> Tap ğŸ”Š to hear pronunciation</p>
                            <p><strong>Tip:</strong> Save words with â­ for later</p>
                        </div>
                    </div>

                    <button id="swipe-tutorial-dismiss" class="swipe-tutorial-btn">
                        Got it!
                    </button>
                </div>
            </div>

            <!-- Achievements Modal -->
            <div id="achievements-modal" class="achievements-modal">
                <div class="achievements-content">
                    <div class="achievements-header">
                        <h2>ğŸ† Achievements</h2>
                        <button id="close-achievements" class="icon-btn">âœ•</button>
                    </div>

                    <!-- Progress to Next Badge -->
                    <div class="next-badge-progress">
                        <div class="next-badge-info">
                            <span class="next-badge-icon">ğŸ¯</span>
                            <div class="next-badge-text">
                                <p class="next-badge-title">Next Badge</p>
                                <p class="next-badge-name">Beginner</p>
                            </div>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar-fill" style="width: 0%;"></div>
                            <span class="progress-bar-text">0 / 10</span>
                        </div>
                    </div>

                    <!-- Achievements Grid -->
                    <div class="achievements-grid">
                        <!-- Word Milestones -->
                        <div class="achievement-category">
                            <h3 class="category-title">ğŸ“š Word Milestones</h3>
                            <div class="badges-grid" id="word-badges-grid">
                                <!-- Badges will be inserted here via JS -->
                            </div>
                        </div>

                        <!-- Streak Milestones -->
                        <div class="achievement-category">
                            <h3 class="category-title">ğŸ”¥ Streak Milestones</h3>
                            <div class="badges-grid" id="streak-badges-grid">
                                <!-- Badges will be inserted here via JS -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PIN Authentication Modal -->
        <div id="pin-modal" class="pin-modal">
            <div class="pin-content">
                <div class="pin-profile-header">
                    <span id="pin-profile-emoji" class="pin-profile-emoji"></span>
                    <h2 id="pin-modal-title">ğŸ”’ Enter PIN</h2>
                    <p id="pin-profile-name" class="pin-profile-name"></p>
                </div>

                <div class="pin-dots">
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                    <div class="pin-dot"></div>
                </div>

                <p id="pin-message" class="pin-message"></p>

                <div class="pin-keypad">
                    <button class="pin-key" data-digit="1">1</button>
                    <button class="pin-key" data-digit="2">2</button>
                    <button class="pin-key" data-digit="3">3</button>
                    <button class="pin-key" data-digit="4">4</button>
                    <button class="pin-key" data-digit="5">5</button>
                    <button class="pin-key" data-digit="6">6</button>
                    <button class="pin-key" data-digit="7">7</button>
                    <button class="pin-key" data-digit="8">8</button>
                    <button class="pin-key" data-digit="9">9</button>
                    <button class="pin-key pin-key-backspace" aria-label="Delete">â†</button>
                    <button class="pin-key" data-digit="0">0</button>
                    <button class="pin-key pin-key-submit" aria-label="Submit">âœ“</button>
                </div>

                <div class="pin-actions">
                    <button id="pin-cancel-btn" class="pin-btn-secondary">Cancel</button>
                    <button id="pin-forgot-btn" class="pin-btn-link" style="display:none;">Forgot PIN?</button>
                </div>
            </div>
        </div>

        <!-- First-Time PIN Setup Modal -->
        <div id="pin-setup-modal" class="pin-modal">
            <div class="pin-content pin-setup-content">
                <div class="pin-setup-header">
                    <span id="pin-setup-emoji" class="pin-profile-emoji"></span>
                    <h2>ğŸ” Protect Your Profile</h2>
                    <p id="pin-setup-name" class="pin-setup-profile-name"></p>
                    <p class="pin-setup-description">Would you like to protect this profile with a 4-digit PIN?</p>
                </div>

                <div class="pin-setup-actions">
                    <button id="pin-setup-skip-btn" class="pin-btn-secondary">Skip for Now</button>
                    <button id="pin-setup-create-btn" class="pin-btn-primary">Create PIN</button>
                </div>
            </div>
        </div>

        <!-- Analytics Stats Modal (Admin View) -->
        <div id="analytics-modal" class="analytics-modal">
            <div class="analytics-content">
                <div class="analytics-header">
                    <h2>ğŸ“Š Usage Statistics</h2>
                    <button id="close-analytics" class="icon-btn">âœ•</button>
                </div>

                <div class="analytics-body">
                    <!-- Summary Stats -->
                    <div class="analytics-section">
                        <h3>Summary</h3>
                        <div class="analytics-stats-grid">
                            <div class="analytics-stat">
                                <span class="stat-value" id="stat-total-sessions">0</span>
                                <span class="stat-label">Total Sessions</span>
                            </div>
                            <div class="analytics-stat">
                                <span class="stat-value" id="stat-total-words">0</span>
                                <span class="stat-label">Total Words</span>
                            </div>
                            <div class="analytics-stat">
                                <span class="stat-value" id="stat-avg-session">0 min</span>
                                <span class="stat-label">Avg Session</span>
                            </div>
                            <div class="analytics-stat">
                                <span class="stat-value" id="stat-total-events">0</span>
                                <span class="stat-label">Total Events</span>
                            </div>
                        </div>
                    </div>

                    <!-- Profile Usage -->
                    <div class="analytics-section">
                        <h3>Most Used Profiles</h3>
                        <div id="analytics-profiles" class="analytics-list">
                            <!-- Will be populated by JS -->
                        </div>
                    </div>

                    <!-- Features -->
                    <div class="analytics-section">
                        <h3>Feature Usage</h3>
                        <div class="analytics-stats-grid">
                            <div class="analytics-stat">
                                <span class="stat-value" id="stat-achievements">0</span>
                                <span class="stat-label">Achievements</span>
                            </div>
                            <div class="analytics-stat">
                                <span class="stat-value" id="stat-saved-words">0</span>
                                <span class="stat-label">Saved Words</span>
                            </div>
                            <div class="analytics-stat">
                                <span class="stat-value" id="stat-avg-streak">0</span>
                                <span class="stat-label">Avg Streak</span>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="analytics-section">
                        <h3>Recent Sessions</h3>
                        <div id="analytics-recent" class="analytics-recent-list">
                            <!-- Will be populated by JS -->
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="analytics-actions">
                        <button id="analytics-export-btn" class="analytics-btn analytics-btn-secondary">
                            Export Data
                        </button>
                        <button id="analytics-clear-btn" class="analytics-btn analytics-btn-danger">
                            Clear All Data
                        </button>
                    </div>

                    <!-- Privacy Notice -->
                    <div class="analytics-privacy-notice">
                        <p>ğŸ”’ All data is stored locally on your device. No external tracking.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="/src/app.js"></script>
</body>
</html>
